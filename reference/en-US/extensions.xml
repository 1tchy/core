<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
   "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd"  [ ]>
<chapter id="extensions">

   <!-- TODO turn this into an extensions primer and have a separate guide for writing
   extensions to CDI that perhaps go into detail about the Weld build -->

   <title>CDI extensions available as part of Weld</title>
   
   <important>
      <para>
         These modules are usable on any JSR-299 implementation, not just Weld!
      </para>
   </important>

   <section>
      <title>Weld Logger</title>
      
      <para>
         Adding logging to your application is now even easier with simple injection of a logger object into any CDI
         bean. Simply create an injection point of type <literal>org.slf4j.Logger</literal> and an appropriate logger 
         object will be injected into any instance of the bean.
      </para>

      <programlisting role="JAVA"><![CDATA[import org.slf4j.Logger;

public class Checkout {
   private @Inject Logger log;

   public void invoiceItems() {
      ShoppingCart cart;
      ...
      log.debug("Items invoiced for {}", cart);
   }
}]]></programlisting>

      <para>
         The example shows how objects can be interpolated into a message. This interpolation is done using
         <emphasis>java.text.MessageFormat</emphasis>, so see the JavaDoc for that class for more details. In this case,
         the <literal>ShoppingCart</literal> should have implemented the <emphasis>toString()</emphasis> method to
         produce a human readable value that is meaningful in messages. Normally, this call would have involved
         evaluating cart.toString() with String concatenation to produce a single String argument. Thus it was necessary
         to surround the call with an if-statement using the condition <emphasis>log.isDebugEnabled()</emphasis> to
         avoid the expensive String concatenation if the message was not actually going to be used. However, when using
         <literal>@Logger</literal>-injected logging, the conditional test can be left out since the object arguments
         are not evaluated unless the message is going to be logged.
      </para>
      
      <note>
	      <para>
            You can add Weld logging to your project by including weld-logger.jar, sl4j-api.jar and sl4j-jdk14.jar to
            your project. Alternatively, express a dependency on the <literal>org.jboss.weld:weld-logger</literal> 
            Maven artifact. 
	      </para>
	      <para>
            If you are using Weld as your JSR-299 implementation, there's no need to include sl4j as it's already
            included (and used internally).
	      </para>
      </note>

   </section>

   <!-- TODO surely we must have other extensions -->
   
<!--
vim:et:ts=3:sw=3:tw=120
-->
</chapter>
